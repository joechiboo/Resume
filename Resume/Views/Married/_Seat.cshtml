
<div role="main" class="ui-content">
    <span>※目前桌子排列尚不準確。</span>
    <br/>
    <span id="tableText"></span>
    <input type="hidden" id="txt">

    <svg height="420" width="300">
        @{
            var column = 5;     // 幾行
            var row = 7;        // 幾列
            var table = 33;     // 幾桌
            var tables = new int[] { 4, 2, 1, 3, 5,
                                     10, 6, 8, 7, 9,
                                     14, 12, 13, 11, 15,
                                     20, 16, 18, 17, 19,
                                     24, 22, 23, 21, 25,
                                     28, 26, 303, 27, 29,
                                     32, 30, 31
                                    };

            var t = 1;
            for (var j = 1; j <= row; j++)
            {
                for (var i = 1; i <= column; i++)
                {
                    var cx = 30 + (60 * (i - 1));
                    var cy = 30 + (60 * (j - 1));

                    if (t <= table)
                    {
                        @:<circle id="@tables[t - 1]" cx="@cx" cy="@cy" r="20" stroke="black" stroke-width="3" fill="none" />
                        if (tables[t - 1] >= 10 && tables[t - 1] < 100)
                        {
                            cx -= 5;
                        }
                        else if (tables[t - 1] >= 100) {
                            cx -= 10;
                        }
                        @:<text x="@(cx - 5)" y="@(cy + 4)" fill="black">@tables[t - 1]</text>
                    }

                    t++;
                }
            }
        }
    </svg>
</div>

<script>
    var c = 0
    var t
    var length = 33;
    var step = 10;

    function Ready() {
        $("circle").hide(1000);
        $("text").hide(1000);

        // Todo api getTalkMember

        $("circle").show(1000);
        $("text").show(1000);

        length = $("circle").size();
    }

    function Go() {
        timedCount();
    }

    function setStep(ms) {
        step = ms;
    }

    function timedCount() {
        $("circle[fill='red']").attr("fill", "none");
        $("circle").eq(c).attr("fill", "red");

        document.getElementById('txt').value = c
        c = c + 1

        t = setTimeout("timedCount()", step)

        if (c >= length) {
            c = 0;
        }
    }

    function Stop() {
        clearTimeout(t);

        var table = $("circle").eq(c - 1).attr("id");
        console.info("恭喜第 " + table + " 桌得獎。");
    }
</script>